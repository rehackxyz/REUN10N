# crypto - spreading-secrets

```
import time

p  = Integer(12670098302188507742440574100120556372985016944156009521523684257469947870807586552014769435979834701674318132454810503226645543995288281801918123674138911)
y1 = Integer(6435837956013280115905597517488571345655611296436677708042037032302040770233786701092776352064370211838708484430835996068916818951183247574887417224511655)

a = Integer(4378187236568178488156374902954033554168817612809876836185687985356955098509507459200406211027348332345207938363733672019865513005277165462577884966531159)
b = Integer(5998166089683146776473147900393246465728273146407202321254637450343601143170006002385750343013383427197663710513197549189847700541599566914287390375415919)
c = Integer(4686793799228153029935979752698557491405526130735717565192889910432631294797555886472384740255952748527852713105925980690986384345817550367242929172758571)
d = Integer(4434206240071905077800829033789797199713643458206586525895301388157719638163994101476076768832337473337639479654350629169805328840025579672685071683035027)

F = GF(p)
R.<x> = PolynomialRing(F, implementation='NTL')

f = (F(a)*x^3 + F(b)*x^2 + F(c)*x + F(d))

state = x
S = x
for _ in range(9):
    state = f(state)
    S += state

h = S - F(y1)  # h(secret)=0
print("degree(h) =", h.degree())

t0 = time.time()
xp = power_mod(x, p, h)
print("done in", round(time.time() - t0, 2), "seconds")

rpoly = h.gcd(xp - x)
print("degree(gcd) =", rpoly.degree())

roots = []
for fac, exp in rpoly.factor():
    if fac.degree() == 1:
        # fac = u*x + v, root = -v/u
        u = fac[1]
        v = fac[0]
        roots.append(Integer((-v)/u))

print("num_roots =", len(roots))

def int_to_bytes(n):
    if n == 0:
        return b"\\x00"
    out = []
    while n > 0:
        out.append(int(n & 0xff))
        n >>= 8
    return bytes(reversed(out))

for r in roots:
    bb = int_to_bytes(r)
    print("root:", r)
    print("bytes:", bb)
    try:
        print("ascii:", bb.decode())
    except Exception:
        pass
```

```
$ sage solvededed.sage
degree(h) = 19683
computing x^p mod h (expected ~1-3 minutes)...
done in 131.07 seconds
degree(gcd) = 2
num_roots = 2
root: 3074298428595709121955875023264800406092811708850679245815173037644479373939992249554695938687996524114338488973319108331132087534396070848444788138651857
bytes: b':\xb2\xdb\x92&z\xbf\xf1\xfe\xa2\x8e\xecwUR\xe1\xe5\xb8\xea\x9cI\xadWR\xae\x17\x9f&\xd5\x0e\xe8^\xc3\x12\x13\xa4\xe4\x1dd\x07BF\xb2s\x0eS\xa7\x05\xee\xe6\xef\x81:\xe8\x13\\\x8b/\xf2\x95\xf3a0\xd1'
root: 86614126311839201073392479341441261431500518590932674991838606941316470152703696752361142839039250579521708405076723034766286435603631894250232291709
bytes: b'lactf{d0nt_d3r1v3_th3_wh0l3_p0lyn0m14l_fr0m_th3_s3cr3t_t00!!!}'
```

SOLVED by Zeqzoq

Solved by: yappare